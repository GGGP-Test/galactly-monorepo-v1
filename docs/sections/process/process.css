/* Section 3 – Process (Docked Steps + Flow Board)
   This CSS expects process.js to mount markup under <div id="section-process"></div>.
   It uses CSS variables so JS can inject colors from PROCESS_DATA.theme.
*/

/* -------------------- Vars + base -------------------- */
#section-process {
  /* fallbacks; JS will overwrite these via element.style.setProperty */
  --p-bg: #0b1119;
  --p-text: #e9f1f7;
  --p-muted: #97a9bc;
  --p-stroke: rgba(255,255,255,.08);

  --p-primary: #E6C36B;   /* warm gold */
  --p-secondary: #7FB2FF; /* cool blue */
  --p-tertiary: #F471B5;  /* magenta */

  --p-cable: rgba(242,220,160,.55);
  --p-cable-dim: rgba(242,220,160,.18);

  --glass-fill: rgba(255,255,255,.06);
  --glass-stroke: rgba(255,255,255,.12);
  --glass-hover: rgba(255,255,255,.10);
  --glass-active: rgba(255,255,255,.16);
  --glass-blur: 10px;

  --pad: 18px;
  --dock-w: 320px;
  --lane-gap: 22px;
  --chip-gap: 12px;
  --radius: 14px;
  --shadow: 0 10px 30px rgba(0,0,0,.28);
  --muted-shadow: 0 10px 24px rgba(0,0,0,.22);
}

.proc-section {
  position: relative;
  padding: 72px 16px;
  color: var(--p-text);
  background: linear-gradient(180deg, rgba(255,255,255,0) 0%, rgba(9,14,22,.35) 100%);
  isolation: isolate;
  overflow: hidden;
}

.proc-inner {
  max-width: 1140px;
  margin: 0 auto;
}

.proc-hd h2 {
  font: 600 clamp(22px,3.6vw,32px) "Newsreader", Georgia, serif;
  margin: 0 0 8px;
}
.proc-hd .sub {
  color: var(--p-muted);
  font-size: 14px;
  margin-bottom: 18px;
}

/* -------------------- Layout grid -------------------- */
.p-wrap {
  display: grid;
  grid-template-columns: var(--dock-w) 1fr;
  gap: 20px;
  align-items: start;
}

/* -------------------- Dock (vertical numbers + CTAs) -------------------- */
.p-dock {
  position: sticky;
  top: 96px;              /* same as header offset */
  align-self: start;
  display: grid;
  grid-template-rows: auto 1fr auto;
  gap: 14px;
  padding: var(--pad);
  border: 1px solid var(--p-stroke);
  border-radius: 16px;
  background: rgba(255,255,255,.03);
  box-shadow: var(--muted-shadow);
  backdrop-filter: saturate(110%) blur(4px);
}

.p-stepper {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 14px;
  padding: 8px 0;
}
.p-step {
  display: grid;
  grid-template-columns: auto 1fr;
  align-items: center;
  gap: 10px;
}
.p-dot {
  width: 34px; height: 34px;
  border-radius: 999px;
  display: grid; place-items: center;
  font-weight: 700;
  color: #0e0e0e;
  user-select: none;
  background: radial-gradient(180deg, var(--p-secondary), #4f8fe6);
  box-shadow:
    0 0 0 1px rgba(255,255,255,.10) inset,
    0 6px 18px rgba(127,178,255,.30);
  transform: translateZ(0); /* tiny 3D feel */
}
.p-step.is-done .p-dot {
  background: radial-gradient(180deg, var(--p-primary), #b8913d);
  box-shadow:
    0 0 0 1px rgba(255,255,255,.10) inset,
    0 6px 18px rgba(230,195,107,.30);
}
.p-step.is-current .p-dot {
  outline: 2px solid rgba(255,255,255,.25);
  outline-offset: 2px;
}
.p-label {
  color: var(--p-muted);
  font-size: 13px;
  opacity: 0;
  transform: translateX(-4px);
  transition: 160ms ease;
}
.p-dock.is-open .p-label { opacity: .85; transform: none; }

/* Glass CTAs (Next / Prev) */
.p-ctas {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}
.btn-glass {
  -webkit-backdrop-filter: blur(var(--glass-blur));
  backdrop-filter: blur(var(--glass-blur));
  background: var(--glass-fill);
  border: 1px solid var(--glass-stroke);
  color: var(--p-text);
  border-radius: 999px;
  padding: 10px 14px;
  font-weight: 700;
  letter-spacing: .2px;
  cursor: pointer;
  box-shadow: 0 8px 24px rgba(0,0,0,.28), 0 0 0 1px rgba(255,255,255,.05) inset;
  transition: background .18s ease, transform .12s ease, border-color .18s ease;
}
.btn-glass:hover   { background: var(--glass-hover); border-color: rgba(255,255,255,.18); }
.btn-glass:active  { background: var(--glass-active); transform: translateY(1px); }
.btn-glass[disabled] { opacity:.45; cursor:not-allowed; }

/* -------------------- Flow board -------------------- */
.p-board {
  position: relative;
  border: 1px solid var(--p-stroke);
  border-radius: 16px;
  padding: calc(var(--pad) + 8px);
  overflow: visible;
  box-shadow: var(--shadow);
  background:
    radial-gradient(100% 140% at 0% 0%,
      rgba(127,178,255,.10) 0%,
      rgba(0,0,0,0) 48%),
    radial-gradient(120% 160% at 100% 100%,
      rgba(244,113,181,.08) 0%,
      rgba(0,0,0,0) 40%);
  min-height: 560px;
}

/* SVG cable layer (neon) */
.proc-svg {
  position: absolute; inset: 0;
  overflow: visible;
  pointer-events: none;
  filter: drop-shadow(0 0 8px rgba(242,220,160,.35));
}
.proc-cable {
  stroke: var(--p-cable);
  stroke-width: 1.4;
  fill: none;
  stroke-linecap: round;
  stroke-linejoin: round;
  animation: cablePulse var(--pulse,2600ms) ease-in-out infinite;
}
.proc-cable.is-dim { stroke: var(--p-cable-dim); animation: none; }
@keyframes cablePulse {
  0%   { filter: drop-shadow(0 0 0 rgba(242,220,160,.0)); }
  35%  { filter: drop-shadow(0 0 10px rgba(242,220,160,.45)); }
  70%  { filter: drop-shadow(0 0 0 rgba(242,220,160,.0)); }
  100% { filter: drop-shadow(0 0 0 rgba(242,220,160,.0)); }
}

/* Lanes */
.p-lanes {
  display: grid;
  grid-template-columns: repeat(4, minmax(0,1fr));
  gap: var(--lane-gap);
  align-items: start;
}
.p-lane {
  position: relative;
  display: grid;
  gap: var(--chip-gap);
  padding: 8px;
}
.p-lane-hd {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  font-weight: 800;
  letter-spacing: .2px;
  color: var(--p-text);
}
.p-lane-hd .badge {
  font-weight: 700;
  font-size: 12px;
  padding: 6px 10px;
  border-radius: 999px;
  color: #0f0f0f;
  background: linear-gradient(180deg, var(--p-primary), #b8913d);
  box-shadow: 0 8px 18px rgba(230,195,107,.25);
}

/* Chips (nodes) – minimal, alive, not “heavy boxes” */
.p-chip {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 10px 12px;
  border-radius: 999px;
  color: var(--p-text);
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(255,255,255,.03);
  box-shadow: 0 6px 18px rgba(0,0,0,.25), 0 0 0 1px rgba(255,255,255,.04) inset;
  white-space: nowrap;
  transform: translateZ(0);
  transition: filter .18s ease, transform .12s ease, background .18s ease, border-color .18s ease;
}
.p-chip .ico { filter: drop-shadow(0 0 6px rgba(127,178,255,.25)); }
.p-chip:hover {
  background: rgba(127,178,255,.08);
  border-color: rgba(127,178,255,.22);
  transform: translateY(-1px);
  filter: saturate(110%);
}
.p-chip.is-focus {
  background: rgba(244,113,181,.10);
  border-color: rgba(244,113,181,.28);
  box-shadow: 0 10px 26px rgba(244,113,181,.18);
}

/* Result card */
.p-result {
  grid-column: span 4;
  justify-self: end;
  max-width: 380px;
  margin-top: 10px;
  padding: 12px 14px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(255,255,255,.04);
  box-shadow: var(--muted-shadow);
  -webkit-backdrop-filter: blur(6px);
  backdrop-filter: blur(6px);
}
.p-result h4 {
  margin: 0 0 6px;
  font-weight: 800;
}
.p-result ul {
  margin: 0; padding-left: 18px;
  color: var(--p-muted);
  font-size: 14px;
}

/* -------------------- Right rail copy (desktop) -------------------- */
.proc-rail {
  margin-top: 16px;
  padding-left: 8px;
}
.proc-step {
  border-left: 2px solid rgba(255,255,255,.12);
  padding: 10px 0 10px 14px;
}
.proc-step h3 { margin: 0 0 4px; font-size: 16px; }
.proc-step p  { margin: 0; color: var(--p-muted); font-size: 14px; }
.proc-step.is-current {
  border-left-color: var(--p-primary);
}
.proc-step.is-current h3 { color: var(--p-primary); }

/* -------------------- Mobile / Tablet -------------------- */
@media (max-width: 820px) {
  .p-wrap { grid-template-columns: 1fr; }
  .p-dock { position: relative; top: auto; order: 0; }
  .p-board { order: 1; min-height: 520px; }
  .p-lanes { grid-template-columns: repeat(2, minmax(0,1fr)); }
  .p-result { grid-column: span 2; justify-self: stretch; }
  .p-stepper { flex-direction: row; justify-content: center; flex-wrap: wrap; }
  .p-step { grid-template-columns: auto; }
  .p-label { display:none; }
}

/* -------------------- Reduced motion -------------------- */
@media (prefers-reduced-motion: reduce) {
  .p-chip, .btn-glass { transition: none; }
  .proc-cable { animation: none; }
}

/* -------------------- Legacy hooks (safe no-op look) -------------------- */
/* If older process.js is still present, keep it quiet so it doesn’t look broken */
.proc-stage, .proc-canvas, .proc-core, .proc-ring, .proc-col-title, .proc-node {
  pointer-events: none;
  opacity: .0;
}


/* Section 3 – Process (heading + spacing master; UI drawn by process.js)
   ───────────────────────────────────────────────────────────────────────
   One source of truth for spacing: the title’s bottom margin.
   Set these on #section-process inline (index.html), e.g.:
     style="
       --proc-title-pad-x:48px; --proc-title-gap:64px; --proc-title-margin-top:24px;
       --proc-title-pad-x-tablet:28px; --proc-title-gap-tablet:44px; --proc-title-margin-top-tablet:16px;
       --proc-title-pad-x-phone:16px;  --proc-title-gap-phone:28px;  --proc-title-margin-top-phone:8px;
     "

   Base knobs (desktop):
     --proc-title-pad-x            : left/right padding for the title text
     --proc-title-gap              : space AFTER the title (pushes the lamp/rail/steps down)
     --proc-title-margin-top       : space BEFORE the title (pushes the title down)

   Tablet overrides (≤900px):
     --proc-title-pad-x-tablet
     --proc-title-gap-tablet
     --proc-title-margin-top-tablet

   Phone overrides (≤640px):
     --proc-title-pad-x-phone
     --proc-title-gap-phone
     --proc-title-margin-top-phone
*/

/* ---------- Theme fallbacks ---------- */
#section-process{
  --p-text:#e9f1f7;

  /* desktop defaults */
  --proc-title-pad-x:24px;
  --proc-title-gap:48px;
  --proc-title-margin-top:300px;

  /* optional per-device overrides (only used if you set them inline) */
  --proc-title-pad-x-tablet: 24px;
  --proc-title-gap-tablet:   28px;
  --proc-title-margin-top-tablet: 0px;

  --proc-title-pad-x-phone: 16px;
  --proc-title-gap-phone:   18px;
  --proc-title-margin-top-phone: 0px;
}

/* ---------- Title (desktop) ---------- */
#section-process .proc-title{
  max-width:1140px;
  /* top | horiz auto | bottom — bottom gap is the spacer before the UI */
  margin: var(--proc-title-margin-top) auto var(--proc-title-gap) !important;
  /* left/right padding only affects the text, not the UI below */
  padding: 0 var(--proc-title-pad-x);
  font:600 clamp(28px,4.8vw,40px)/1.15 "Newsreader", Georgia, serif;
  letter-spacing:-.01em;
  color:var(--p-text);
}
#section-process .proc-title .accent-gold{
  color:#F6D36F;
  text-shadow:0 0 8px rgba(246,211,111,.18);
  font-weight:600;
}
#section-process .proc-title .nowrap{ white-space:nowrap; }

/* The UI block inserted by process.js sits right after the title.
   Kill any stray top margins so the title’s bottom margin is the only spacer. */
#section-process .proc{ margin-top:0 !important; }

/* ---------- Tablet (≤900px) ---------- */
@media (max-width:900px){
  /* Swap in tablet overrides; if you didn't set them, fall back to the defaults above */
  #section-process{
    --proc-title-pad-x:     var(--proc-title-pad-x-tablet, var(--proc-title-pad-x));
    --proc-title-gap:       var(--proc-title-gap-tablet,   var(--proc-title-gap));
    --proc-title-margin-top:var(--proc-title-margin-top-tablet, var(--proc-title-margin-top));
  }
  #section-process .proc-title{ text-align:center; }
}

/* ---------- Phone (≤640px) ---------- */
@media (max-width:640px){
  /* Swap in phone overrides; if you didn't set them, fall back gracefully */
  #section-process{
    --proc-title-pad-x:     var(--proc-title-pad-x-phone, var(--proc-title-pad-x));
    --proc-title-gap:       var(--proc-title-gap-phone,   var(--proc-title-gap));
    --proc-title-margin-top:var(--proc-title-margin-top-phone, var(--proc-title-margin-top));
  }
  #section-process .proc-title{ text-align:center; }
}

/* ---------- Legacy hooks (no-op so old markup doesn’t flash) ---------- */
.proc-stage, .proc-canvas, .proc-core, .proc-ring, .proc-col-title, .proc-node{
  pointer-events:none; opacity:0;
}







