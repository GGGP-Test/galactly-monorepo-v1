<!-- docs/start.html -->
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Get started â€” Galactly</title>

<!-- Fonts (match landing) -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Newsreader:wght@600&family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">

<link rel="icon" href="data:,">

<style>
  :root{
    --bg:#0a0e14; --panel:#101623; --stroke:#1b2531;
    --text:#e9f1f7; --muted:#91a6b8;
    --gold:#e6c36b; --gold-700:#b8913d; --gold-300:#f2dca0;
    --ctaText:#1b1405;
  }
  *{box-sizing:border-box}
  html,body{margin:0;height:100%;background:var(--bg);color:var(--text);
    font:16px/1.55 Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;}
  a{color:inherit;text-decoration:none}

  /* Header (simple, consistent) */
  .site-header{position:sticky;top:0;z-index:10;height:60px;display:grid;place-items:center;
    background:rgba(12,18,28,.38); -webkit-backdrop-filter:blur(12px) saturate(140%);
    backdrop-filter:blur(12px) saturate(140%); border-bottom:1px solid rgba(255,255,255,.06)}
  .site-header .inner{max-width:1100px;width:100%;padding:0 16px;display:flex;align-items:center;justify-content:space-between;gap:12px}
  .brand{display:flex;align-items:center;gap:10px}
  .brand-badge{width:28px;height:28px;border-radius:8px;background:linear-gradient(180deg,var(--gold),var(--gold-700));
    box-shadow:0 0 0 1px rgba(255,255,255,.08) inset; display:grid; place-items:center; color:#1b1405; font-weight:800; font-size:14px}

  /* Layout */
  .wrap{min-height:calc(100svh - 60px); display:grid; place-items:center; padding:40px 16px}
  .card{width:min(860px, 92vw); border-radius:18px; background:linear-gradient(180deg,#0b121d,#0b1119);
    border:1px solid rgba(255,255,255,.10); box-shadow:0 20px 50px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.06);
    display:flex; flex-direction:column; overflow:hidden}
  .card-hd{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1px solid rgba(255,255,255,.06)}
  .steps{display:flex;gap:8px;align-items:center}
  .steps .dot{width:8px;height:8px;border-radius:50%;background:rgba(255,255,255,.22);box-shadow:0 0 0 1px rgba(255,255,255,.12) inset}
  .steps .dot.on{background:linear-gradient(180deg,var(--gold),var(--gold-700))}
  .api-badge{font-size:12px;color:#cfe2ff;opacity:.9;background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.08);padding:5px 7px;border-radius:8px}
  .card-bd{padding:14px 16px}
  .pill{display:inline-block;margin:2px 0 6px;padding:6px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.08);background:rgba(255,255,255,.03);color:#91a6b8;font-size:12px}
  h2{font:600 clamp(22px,3.2vw,28px) "Newsreader", Georgia, serif; margin:10px 0 14px}
  .accordion{border:1px solid rgba(255,255,255,.08);border-radius:12px;background:rgba(255,255,255,.03);overflow:hidden}
  .acc-hd{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;border-bottom:1px solid rgba(255,255,255,.06)}
  .acc-bd{padding:14px}

  .chips{display:flex;gap:10px;flex-wrap:wrap}
  .chip{padding:8px 12px;border-radius:999px;border:1px solid rgba(255,255,255,.10);background:rgba(255,255,255,.05);cursor:pointer}
  .chip.active{background:linear-gradient(180deg,var(--gold),var(--gold-700)); color:var(--ctaText); border:none}
  .hint{font-size:12px;color:#8ba6bf}

  .grid2{display:grid;grid-template-columns:1fr 1fr;gap:18px}
  @media (max-width:720px){ .grid2{grid-template-columns:1fr} }

  .field{display:flex;flex-direction:column;gap:8px}
  .field label{font-weight:600;color:#cfe0ee}
  .field input{padding:12px 14px;border-radius:10px;border:1px solid var(--stroke);background:rgba(255,255,255,.02);color:var(--text);outline:none}
  .field input::placeholder{color:#9fb3c7;opacity:.95}
  .field input:focus{border-color:#2b445c; box-shadow:0 0 0 2px rgba(99,211,255,.18) inset}

  .card-ft{display:flex;justify-content:space-between;align-items:center;padding:14px 16px;border-top:1px solid rgba(255,255,255,.06)}
  .btn{display:inline-flex;align-items:center;gap:.6rem;padding:12px 18px;border-radius:999px;border:1px solid var(--stroke);cursor:pointer;background:rgba(255,255,255,.02);color:#cfe0ee;font-weight:600}
  .btn.ghost{background:transparent}
  .btn.primary{color:var(--ctaText);background:linear-gradient(180deg,var(--gold),var(--gold-700));border:none;box-shadow:0 10px 30px rgba(230,195,107,.15),0 0 0 1px rgba(255,255,255,.06) inset}
  .btn.inline{padding:8px 12px;border-radius:10px}
  .btn:active{transform:translateY(1px)}
  .topbar{display:flex;align-items:center;gap:10px}
  .topbar a{opacity:.9}
  .topbar a:hover{opacity:1}

  /* Step 2B website confirmation */
  .website-card{
    display:flex;align-items:center;gap:12px;
    padding:16px;border-radius:12px;border:1px solid rgba(255,255,255,.10);
    background:rgba(255,255,255,.03);
  }
  .site-chip{
    display:inline-flex;align-items:center;gap:8px;
    padding:8px 12px;border-radius:999px;border:1px solid rgba(255,255,255,.10);
    background:rgba(255,255,255,.05); font-weight:700;
  }
  .lock{width:16px;height:16px;opacity:.9}
  .ghost-note{font-size:12px;color:#9fb3c7}
  .center{display:grid;place-items:center}
</style>
</head>
<body>
  <!-- Simple header -->
  <header class="site-header" aria-label="Site">
    <div class="inner">
      <a href="index.html" class="brand" aria-label="Home"><span class="brand-badge" aria-hidden="true">G</span></a>
      <div class="topbar">
        <a href="index.html">Back to site</a>
      </div>
    </div>
  </header>

  <main class="wrap">
    <div class="card" role="region" aria-label="Onboarding">
      <div class="card-hd">
        <div class="steps" aria-label="Steps">
          <span class="dot on" data-step-dot="0"></span>
          <span class="dot" data-step-dot="1"></span>
          <span class="dot" data-step-dot="2"></span>
        </div>
        <div style="display:flex;gap:10px;align-items:center">
          <span id="apiBadge" class="api-badge">Ready</span>
        </div>
      </div>

      <div class="card-bd">
        <!-- Step 1 -->
        <section class="step" id="step1">
          <div class="pill">Get set up in 60 seconds</div>
          <h2>Pick your side</h2>
          <div class="accordion" role="group" aria-labelledby="roleLegend">
            <div class="acc-hd"><h4 id="roleLegend" style="margin:0">Role</h4><div class="hint">Required</div></div>
            <div class="acc-bd">
              <div class="chips" id="roleChips">
                <span id="opt-supplier" class="chip active" role="button" tabindex="0" aria-pressed="true">ðŸ™Œ I sell packaging (Supplier)</span>
                <span id="opt-buyer" class="chip" role="button" tabindex="0" aria-pressed="false">ðŸ›’ I buy packaging (Buyer)</span>
              </div>
            </div>
          </div>
        </section>

        <!-- Step 2A -->
        <section class="step" id="step2a" hidden>
          <div class="pill">Step 2 of 3</div>
          <h2>Tell us who you are</h2>
          <div class="accordion" role="group" aria-labelledby="contactLegend">
            <div class="acc-hd"><h4 id="contactLegend" style="margin:0">Contact</h4><div class="hint">Email required</div></div>
            <div class="acc-bd">
              <div class="grid2">
                <div>
                  <div class="field">
                    <label for="name">Your name</label>
                    <input id="name" type="text" autocomplete="name" placeholder="e.g., Sam Carter">
                  </div>
                  <div class="field">
                    <label for="phone">Phone <span class="ghost-note">(optional â€” for alerts)</span></label>
                    <input id="phone" type="tel" inputmode="tel" autocomplete="tel" placeholder="+1 555 123 4567">
                  </div>
                </div>
                <div>
                  <div class="field">
                    <label for="email">Business email *</label>
                    <input id="email" type="email" autocomplete="email" placeholder="name@yourcompany.com" required>
                    <div id="emailHint" class="hint" aria-live="polite"></div>
                  </div>
                </div>
              </div>
              <div class="hint" style="margin-top:8px">
                Your website will be detected from your email domain and confirmed next.
              </div>
            </div>
          </div>
        </section>

        <!-- Step 2B -->
        <section class="step" id="step2b" hidden>
          <div class="pill">Step 3 of 3</div>
          <h2>Confirm your website</h2>
          <div class="website-card" role="group" aria-labelledby="webLegend">
            <svg class="lock" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
              <path d="M12 2a5 5 0 0 0-5 5v3H6a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8a2 2 0 0 0-2-2h-1V7a5 5 0 0 0-5-5Zm-3 8V7a3 3 0 1 1 6 0v3H9Z"/>
            </svg>
            <span class="site-chip" id="siteChip">yourcompany.com</span>
          </div>
          <div class="hint" style="margin-top:10px">We lock your domain to match your business email.</div>
          <div style="display:flex;gap:10px;align-items:center;margin-top:12px">
            <button id="confirmSite" class="btn primary" type="button">Yes, thatâ€™s my website</button>
            <button id="changeSite" class="btn inline" type="button">Not my website</button>
          </div>
        </section>
      </div>

      <div class="card-ft">
        <button id="back" class="btn ghost" type="button">Back</button>
        <button id="next" class="btn primary" type="button">Next</button>
      </div>
    </div>
  </main>

  <!-- Shared helpers (created earlier) -->
  <script src="./js/onb.common.js"></script>

  <script>
  (function(){
    const dots = [...document.querySelectorAll("[data-step-dot]")];
    const backBtn = document.getElementById("back");
    const nextBtn = document.getElementById("next");
    const confirmBtn = document.getElementById("confirmSite");
    const changeBtn  = document.getElementById("changeSite");

    const optSupplier = document.getElementById("opt-supplier");
    const optBuyer = document.getElementById("opt-buyer");

    const emailEl = document.getElementById("email");
    const emailHint = document.getElementById("emailHint");
    const phoneEl = document.getElementById("phone");
    const nameEl  = document.getElementById("name");
    const siteChip = document.getElementById("siteChip");

    const state = {
      step: 0,               // 0: role, 1: step2a, 2: step2b
      role: "supplier",
      host: "",              // normalized domain
      userEditedEmailDomain: false
    };

    /* ---------- UI helpers ---------- */
    function show(step){
      state.step = step;
      document.getElementById("step1").hidden = step !== 0;
      document.getElementById("step2a").hidden = step !== 1;
      document.getElementById("step2b").hidden = step !== 2;
      dots.forEach((d,i)=> d.classList.toggle("on", i <= step));
      backBtn.style.visibility = step === 0 ? "hidden" : "visible";
      nextBtn.style.display = (step === 2) ? "none" : "";
      if (step === 0) nextBtn.textContent = "Next";
      if (step === 1) nextBtn.textContent = "Continue";
      if (step === 2) updateSiteChip();
    }

    function setRole(r){
      state.role = r;
      ONB.setRoleUI?.(r);
      optSupplier?.setAttribute("aria-pressed", String(r==="supplier"));
      optBuyer?.setAttribute("aria-pressed", String(r==="buyer"));
      optSupplier?.classList.toggle("active", r==="supplier");
      optBuyer?.classList.toggle("active", r==="buyer");
    }

    function updateSiteChip(){
      const h = state.host || "yourcompany.com";
      siteChip.textContent = h;
      emailHint.textContent = state.host ? ("Weâ€™ll use your domain: @" + h) : "";
    }

    function setHost(raw, source){
      const h = ONB.normHost(raw||"");
      if (!h) return;
      state.host = h;
      // If user hasn't manually changed the email domain, keep the domain part in sync.
      const v = emailEl.value.trim();
      const hasAt = v.includes("@");
      if (!state.userEditedEmailDomain){
        if (!hasAt && v){
          // v = local-part only; append @host live.
          emailEl.value = v + "@" + h;
        }else if (hasAt){
          const local = v.split("@")[0];
          emailEl.value = local + "@" + h;
        }
      }
      updateSiteChip();
    }

    function domainFromEmailLive(){
      const v = emailEl.value.trim();
      const d = ONB.domainFromEmail(v);
      return d || "";
    }

    /* ---------- Event wiring ---------- */
    // Role chips
    optSupplier?.addEventListener("click", ()=> setRole("supplier"));
    optBuyer?.addEventListener("click", ()=> setRole("buyer"));
    optSupplier?.addEventListener("keydown",(e)=>{ if(e.key==="Enter"||e.key===" "){ e.preventDefault(); setRole("supplier"); }});
    optBuyer?.addEventListener("keydown",(e)=>{ if(e.key==="Enter"||e.key===" "){ e.preventDefault(); setRole("buyer"); }});

    // Email typing: detect whether user edits domain part; live-sync host.
    emailEl?.addEventListener("input", ()=>{
      const v = emailEl.value;
      const at = v.indexOf("@");
      if (at >= 0){
        const right = v.slice(at+1);
        // If they touched the domain portion, mark as manual.
        state.userEditedEmailDomain = right.length > 0;
        const d = ONB.normHost(right);
        if (d){ state.host = d; updateSiteChip(); }
      }else{
        // No '@' yet â†’ if we already know host, softly show hint only.
        updateSiteChip();
      }
    });

    // On blur, if they never typed '@' but we have host, auto-complete email.
    emailEl?.addEventListener("blur", ()=>{
      const v = emailEl.value.trim();
      if (v && !v.includes("@") && state.host){
        emailEl.value = v + "@" + state.host;
        state.userEditedEmailDomain = false;
      }
    });

    // Footer nav
    backBtn?.addEventListener("click", ()=>{
      show(Math.max(0, state.step - 1));
      if (state.step === 1){ emailEl.focus(); }
    });

    nextBtn?.addEventListener("click", ()=>{
      if (state.step === 0){ show(1); return; }
      if (state.step === 1){
        // Validate email + derive host
        const email = emailEl.value.trim();
        if (!email || !email.includes("@")){ alert("Please enter your business email."); emailEl.focus(); return; }
        const d = domainFromEmailLive();
        if (!d){ alert("Please use a business email (with a valid domain)."); emailEl.focus(); return; }
        setHost(d, "email");
        show(2);
        return;
      }
    });

    // Step 2B actions
    confirmBtn?.addEventListener("click", ()=>{
      // Persist seed and go to step3.html
      const seed = ONB.writeSeed({
        role: state.role,
        host: state.host,
        contact: { name: nameEl.value.trim(), phone: phoneEl.value.trim(), email: emailEl.value.trim() }
      });
      ONB.goToStep3(seed, "step3.html");
    });

    changeBtn?.addEventListener("click", ()=>{
      // Go back so they can change email (domain).
      show(1);
      // Put cursor after '@' if present, to nudge them to change domain.
      emailEl.focus();
      const v = emailEl.value; const at = v.indexOf("@");
      if (at >= 0){
        emailEl.setSelectionRange(at+1, v.length);
      }
      // Let them take over domain edits now.
      state.userEditedEmailDomain = true;
    });

    // Enter to advance (but not inside inputs)
    document.addEventListener("keydown",(e)=>{
      const tag = (e.target && e.target.tagName) || "";
      if(e.key==="Enter" && !["INPUT","TEXTAREA","BUTTON","A","SELECT"].includes(tag)){
        e.preventDefault();
        if (state.step === 2){ confirmBtn.click(); } else { nextBtn.click(); }
      }
    });

    /* ---------- Prefill from seed / query ---------- */
    const initial = ONB.readSeed?.() || {};
    setRole(initial.role || "supplier");

    // Seed: host from landing hero
    if (initial.host){ setHost(initial.host, "seed"); }

    // Seed: contact fields
    if (initial.contact){
      if (initial.contact.name)  nameEl.value  = initial.contact.name;
      if (initial.contact.phone) phoneEl.value = initial.contact.phone;
      if (initial.contact.email){
        emailEl.value = initial.contact.email;
        const d = ONB.domainFromEmail(initial.contact.email);
        if (d) setHost(d, "email");
      }
    }

    // If we have a host but email lacks '@', show suffix hint
    updateSiteChip();
    show(0);
  })();
  </script>
</body>
</html>