<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Galactly — Live packaging buyer signals</title>
  <script src="./config.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{ --ink:#eaf0ff; --mut:#a6b2c9; --line:#1f2a3e; --panel:#0b121d; --pill:#101a2c; }
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0; font:500 14px Inter,system-ui; color:var(--ink);
      background: radial-gradient(1200px 700px at 80% -10%, rgba(70,110,180,.22), transparent 40%), #070b12;}
    header{height:60px; display:flex; align-items:center; justify-content:space-between; padding:0 16px; border-bottom:1px solid var(--line); background:linear-gradient(180deg,#0b111b,#0a0e15)}
    .badge{display:inline-flex; gap:8px; align-items:center; padding:8px 12px; border:1px solid var(--line); border-radius:999px; background:var(--pill)}
    .badge .dot{width:8px;height:8px;border-radius:50%;background:#3ae0b4; box-shadow:0 0 10px rgba(58,224,180,.7)}
    .wrap{max-width:1280px; margin:0 auto; padding:24px 16px}
    .hero{display:grid; grid-template-columns:minmax(420px, 52%) 1fr; gap:24px; align-items:center}
    @media (max-width:1080px){ .hero{grid-template-columns:1fr} }
    .h1{font-weight:800; font-size:clamp(34px,6vw,56px); line-height:1.06; letter-spacing:-.01em; margin:0 0 10px}
    .sub{color:#cfdbff; opacity:.9; margin:0 0 12px}
    .btn{border-radius:14px; padding:12px 16px; font-weight:700; background:var(--pill); border:1px solid var(--line); color:var(--ink); cursor:pointer}
    .btn.primary{background:linear-gradient(90deg,#fff,#e6efff); color:#0b111b; border-color:transparent}
    .kv{font-size:12px; color:#c6d5f3}
    .right{position:relative; height:520px; border:1px solid var(--line); border-radius:18px; overflow:hidden;
      background: radial-gradient(600px 380px at 50% 55%, rgba(120,160,255,.12), rgba(10,14,22,1) 70%);}
    .core{position:absolute; left:50%; top:52%; width:220px; height:220px; margin:-110px 0 0 -110px; border-radius:50%;
      background:radial-gradient(circle at 50% 50%, rgba(255,255,255,.95), rgba(200,230,255,.4) 45%, rgba(140,170,220,.06) 65%, transparent 70%);}
    .beam{position:absolute; left:50%; top:52%; width:2px; height:1px; background:linear-gradient(180deg,rgba(255,255,255,.9),transparent); transform-origin:0 0}
    .chips{position:absolute; left:12px; right:12px; bottom:12px; display:flex; gap:8px; flex-wrap:wrap}
    .chip{display:inline-flex; align-items:center; gap:8px; padding:7px 10px; border:1px solid #27324a; border-radius:999px; background:rgba(10,16,28,.85); color:#cfe0ff; font-size:12px}
    .debug{font-size:11px; color:#9ab2d9; opacity:.9; margin-top:8px}
  </style>
</head>
<body>
<header>
  <div class="badge"><span class="dot"></span><span id="presenceTxt">0 online</span></div>
  <div class="kv" id="quotaKv">— searches • — reveals</div>
</header>

<div class="wrap">
  <section class="hero">
    <div>
      <h1 class="h1">Find US &amp; Canada Packaging Buyers in &lt;30s</h1>
      <p class="sub">Dev mode is fully open (no sign-up, no quotas). Flip it back when you launch.</p>
      <div style="display:flex;gap:10px">
        <a class="btn primary" href="./free-panel.html">Open Live Feed</a>
        <a class="btn" href="./free-panel.html">Try a scan</a>
      </div>
      <div class="debug" id="dbg"></div>
    </div>
    <div class="right" aria-hidden="true">
      <div class="core"></div>
      <div class="beam" style="transform:rotate(-8deg) scale(260)"></div>
      <div class="beam" style="transform:rotate(12deg) scale(240)"></div>
      <div class="beam" style="transform:rotate(26deg) scale(200)"></div>
      <div class="chips">
        <div class="chip">Leads / 30s <strong>live</strong></div>
        <div class="chip">Ready now <strong>live</strong></div>
        <div class="chip">Quoted <strong>live</strong></div>
      </div>
    </div>
  </section>
</div>

<script>
(function(){
  const uidKey='gal_uid';
  let UID = localStorage.getItem(uidKey);
  if(!UID){ UID = 'u-' + Math.random().toString(36).slice(2,12); localStorage.setItem(uidKey, UID); }

  function normalizeHost(v){ let s=(v||window.API_DEFAULT||location.origin).toString().trim(); s=s.replace(/\/api\/v1\/?$/,'').replace(/\/$/,''); return s; }
  const HOST   = normalizeHost(localStorage.getItem('apiBase') || window.API_DEFAULT);
  const API    = HOST + '/api/v1';
  localStorage.setItem('apiBase', HOST);

  async function api(path,opt){
    const o=opt||{}; const headers=new Headers(o.headers||{});
    headers.set('x-galactly-user', UID);
    if(localStorage.getItem('gal_unlim')==='true') headers.set('x-dev-unlim','true');
    const res = await fetch(API + path, { ...o, headers, mode:'cors' });   // ← NO credentials
    if(!res.ok) throw new Error('HTTP '+res.status);
    return res.json();
  }

  document.getElementById('dbg').textContent = `[api] ${HOST}  uid=${UID}  unlim=${localStorage.getItem('gal_unlim')==='true'}`;

  async function presence(){ try{ const j=await api('/presence/online'); document.getElementById('presenceTxt').textContent=(j.total||0)+' online'; }catch{} }
  async function status(){ try{ const j=await api('/status'); const q=j.quota||{}; const s=(j.devUnlimited?'∞':q.findsLeft??'—'); const r=(j.devUnlimited?'∞':q.revealsLeft??'—'); document.getElementById('quotaKv').textContent=`${s} searches • ${r} reveals`; }catch{} }

  presence(); setInterval(presence, 10000);
  status();   setInterval(status,   12000);
})();
</script>
</body>
</html>
