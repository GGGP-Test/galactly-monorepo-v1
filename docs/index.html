<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Galactly — Live packaging buyer signals</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Montserrat:wght@800&display=swap" rel="stylesheet">
<style>
:root{
  --ink:#eaf0ff; --mut:#a6b2c9; --line:#1e2737; --card:#0f1420; --panel:#0b101a; --pill:#10182a;
  --accent:#86f7d6; --accent2:#6fb3ff; --ok:#7fffd4; --bad:#ff8a8a;
  --mont:Montserrat,Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial,sans-serif;
  --inter:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial,sans-serif;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; color:var(--ink);
  background:
    radial-gradient(1200px 700px at 85% -10%, rgba(40,70,140,.28), transparent 40%),
    linear-gradient(180deg, #0a0e16, #06080e 60%);
  font-family:var(--inter);
}

/* Header */
header{height:60px; display:flex; align-items:center; justify-content:space-between; padding:0 18px; border-bottom:1px solid var(--line); background:linear-gradient(180deg,#0b111b,#0a0e15)}
.brand{display:flex; gap:10px; align-items:center; font:800 16px var(--mont)}
.brand svg{width:22px;height:22px}
.badge{display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border:1px solid var(--line); border-radius:999px; color:#c9d6f0; background:#0c1322; font-size:12px}
.badge .dot{width:8px;height:8px;border-radius:50%;background:#43e5b7;box-shadow:0 0 10px rgba(67,229,183,.7);display:inline-block}

/* Hero layout */
.wrap{max-width:1280px; margin:0 auto; padding:26px 18px}
.hero{display:grid; grid-template-columns:minmax(420px, 52%) 1fr; gap:26px; align-items:center}
@media (max-width:1080px){ .hero{grid-template-columns:1fr} }

/* Left copy */
.h1{font:800 clamp(34px,6vw,56px) var(--mont); letter-spacing:-.02em; line-height:1.06; margin:0 0 12px}
.h1 .hi{color:var(--accent)}
.h1 .t{color:#9ec8ff}
.sub{color:#cfdbff; opacity:.9; font-size:15px; margin:0 0 12px}
.cta{margin-top:16px; display:flex; gap:10px; align-items:center; flex-wrap:wrap}
.btn{border-radius:14px; padding:12px 16px; font:700 14px var(--inter); background:var(--pill); border:1px solid var(--line); color:var(--ink); cursor:pointer}
.btn.primary{background:linear-gradient(90deg,#fff,#e6efff); color:#0b111b; border-color:transparent; box-shadow:0 6px 18px rgba(208,228,255,.08)}
.btn.ghost{background:#0f1626}
.kv{margin-top:10px; font-size:12px; color:#c6d5f3; opacity:.95}

/* ===== Right hero (namespaced) ===== */
.hright{
  position:relative;
  height:520px;
  border:1px solid #1e2737;
  border-radius:18px;
  overflow:hidden;
  background:radial-gradient(600px 380px at 43% 55%, rgba(120,160,255,.14), rgba(10,14,22,1) 65%);
  box-shadow:inset 0 0 0 1px rgba(255,255,255,.02), 0 18px 70px rgba(0,0,0,.45);
}
#hero-right-canvas{
  width:100%; height:100%; display:block;
  pointer-events:none; /* prevents click-blocking over your CTAs */
}

/* KPI chips */
.hright-kpis{
  position:absolute; left:18px; right:18px; bottom:14px;
  display:flex; gap:10px; flex-wrap:wrap;
}
.hright-chip{
  display:inline-flex; align-items:center; gap:8px;
  padding:7px 10px; border:1px solid #26314a; border-radius:999px;
  background:rgba(10,16,28,.82); color:#cfe0ff; font-size:12px;
  backdrop-filter: blur(6px);
}
.hright-chip strong{ color:#fff; }

/* Optional small-screen tweak */
@media (max-width: 1080px){
  .hright{ height:420px; }
}

/* Modal */
.modal{position:fixed; inset:0; background:rgba(0,0,0,.55); display:none; align-items:center; justify-content:center; z-index:50}
.modal.in{display:flex}
.box{width:min(920px,95vw); background:#0b101a; border:1px solid var(--line); border-radius:16px; overflow:hidden}
.box .head{display:flex; align-items:center; justify-content:space-between; padding:12px 14px; border-bottom:1px solid var(--line)}
.box h3{margin:0; font:800 16px var(--mont)}
.seg{display:flex; gap:6px}
.tab{padding:8px 10px; border:1px solid var(--line); border-radius:999px; font:700 12px var(--inter); cursor:pointer}
.tab.active{background:linear-gradient(90deg,#fff,#e6efff); color:#10131a; border-color:transparent}
.pane{display:grid; grid-template-columns:1.08fr 1fr; gap:16px; padding:14px}
@media (max-width: 900px){ .pane{grid-template-columns:1fr} }
.card{background:#0f1420; border:1px solid var(--line); border-radius:14px; padding:12px}
.label{font-size:12px; opacity:.9; margin-bottom:6px}
.input, select, textarea{width:100%; background:#0f1420; border:1px solid var(--line); color:#e9eef7; border-radius:10px; padding:10px 12px; font:500 13px var(--inter)}
.grid2{display:grid; grid-template-columns:1fr 1fr; gap:10px}
.actions{display:flex; gap:10px; align-items:center; padding:12px 0 0}
.err{color:var(--bad); font-size:12px; margin-top:6px; display:none}
.ok{color:#a7ffde; font-size:12px; margin-top:6px; display:none}
.small{font-size:12px; opacity:.85}
.hr{height:1px; background:linear-gradient(90deg,transparent,#243048,transparent); margin:12px 0}

/* Video modal (demo) */
.vmodal .box{width:min(1000px,96vw); padding:0}
.vhead{display:flex; align-items:center; justify-content:space-between; padding:10px 12px; border-bottom:1px solid var(--line)}
.vbody{position:relative; padding-bottom:56.25%; height:0}
.vbody iframe{position:absolute; inset:0; width:100%; height:100%; border:0}
</style>
</head>
<body>
<header>
  <a class="brand" href="#">
    <svg viewBox="0 0 64 64" aria-hidden="true"><defs><linearGradient id="g" x1="0" y1="0" x2="1" y2="1"><stop offset="0" stop-color="#86f7d6"/><stop offset="1" stop-color="#57a4ff"/></linearGradient></defs><circle cx="32" cy="32" r="28" stroke="url(#g)" stroke-width="2" fill="none"/><circle cx="20" cy="20" r="6" fill="url(#g)"/></svg>
    <span>Galactly</span>
  </a>
  <span class="badge"><span class="dot"></span><span id="presenceTxt">0 online</span></span>
</header>

<div class="wrap">
  <section class="hero">
    <div>
      <h1 class="h1">Find US &amp; Canada <span class="hi">Packaging</span> Buyers in <span class="t">&lt;30s</span></h1>
      <p class="sub">Real posts &amp; tenders from public feeds. Free viewer; paid automations, priority, CRM &amp; reporting.</p>
      <p class="sub">Built for packaging owners &amp; sales teams. Outputs: Quote • Email • SMS • Call • LinkedIn DM • ERP updates. No coding. Just clicks.</p>
      <div class="cta">
        <a class="btn primary" id="openFeed" href="./free-panel.html">Open the Live Feed</a>
        <button class="btn ghost" id="watchDemo">▸ Watch 90s demo</button>
        <span class="kv">AI closed <strong>16%</strong> • Rep closed <strong>21%</strong> • Saved / mo <strong>$20,678</strong></span>
      </div>
    </div>

    <!-- RIGHT HERO -->
    <div id="hero-right" class="hright">
      <canvas id="hero-right-canvas" aria-hidden="true"></canvas>
      <div class="hright-kpis">
        <div class="hright-chip">Leads / 30s <strong id="hr_k_leads">0</strong></div>
        <div class="hright-chip">First connection <strong>6 sec</strong></div>
        <div class="hright-chip">Ready now <strong id="hr_k_ready">54%</strong></div>
        <div class="hright-chip">Quoted <strong id="hr_k_quoted">67%</strong></div>
        <div class="hright-chip">Rep closed <strong id="hr_k_rep">21%</strong></div>
        <div class="hright-chip">Saved / mo <strong id="hr_k_saved">$20,678</strong></div>
      </div>
    </div>
  </section>
</div>

<!-- Onboarding modal (Path A/B) -->
<div class="modal" id="onb">
  <div class="box">
    <div class="head">
      <h3>Onboarding</h3>
      <div class="seg">
        <button class="tab active" id="tabA">Path A — Enter your website</button>
        <button class="tab" id="tabB">Path B — Customize from scratch</button>
      </div>
    </div>
    <div class="pane">
      <div>
        <!-- PATH A -->
        <div class="card" id="paneA">
          <div class="label">Preferred — we’ll auto-derive ICPs, buyers, and regions.</div>
          <div class="grid2">
            <div><div class="label">Business email *</div><input id="a_email" class="input" placeholder="you@yourcompany.com"/></div>
            <div><div class="label">Your role *</div>
              <select id="a_role" class="input">
                <option value="supplier">Supplier</option>
                <option value="distributor">Distributor/Wholesaler</option>
                <option value="buyer">Packaging Buyer</option>
              </select>
            </div>
          </div>
          <div class="label" style="margin-top:8px">Company website *</div>
          <input id="a_site" class="input" placeholder="yourcompany.com"/>
          <div class="grid2" style="margin-top:8px">
            <div><div class="label">Region</div><input id="a_region" class="input" placeholder="e.g., US, CA"/></div>
            <div><label style="display:flex; align-items:center; gap:8px; margin-top:22px"><input type="checkbox" id="a_list"/> <span>List my company for inbound opportunities</span></label></div>
          </div>
          <div class="hr"></div>
          <div class="small">We only serve <strong>packaging</strong>. Business email domain must match your company site.</div>
          <div class="err" id="a_err"></div><div class="ok" id="a_ok"></div>
          <div class="actions"><button class="btn" id="a_cancel">Cancel</button><button class="btn primary" id="a_continue">Continue</button></div>
        </div>

        <!-- PATH B -->
        <div class="card" id="paneB" style="display:none">
          <div class="label">Manual — precise filters if you prefer to steer.</div>
          <div class="grid2">
            <div><div class="label">Business email *</div><input id="b_email" class="input" placeholder="you@yourcompany.com"/></div>
            <div><div class="label">Your role *</div>
              <select id="b_role" class="input">
                <option value="supplier">Supplier</option>
                <option value="distributor">Distributor/Wholesaler</option>
                <option value="buyer">Packaging Buyer</option>
              </select>
            </div>
          </div>
          <div class="label" style="margin-top:8px">Company website *</div>
          <input id="b_site" class="input" placeholder="yourcompany.com"/>
          <div class="grid2" style="margin-top:8px">
            <div><div class="label">Industries</div><input id="b_industries" class="input" placeholder="beverage, confectionery"/></div>
            <div><div class="label">Regions</div><input id="b_regions" class="input" placeholder="US, CA, EU"/></div>
          </div>
          <div class="label" style="margin-top:8px">Seed buyers (domains)</div>
          <input id="b_buyers" class="input" placeholder="brand1.com, brand2.com"/>
          <div class="label" style="margin-top:8px">Describe your ideal customers</div>
          <textarea id="b_desc" rows="4" class="input" placeholder="categories, packaging materials, order sizes, retailer channels, exclusions"></textarea>
          <label style="display:flex; align-items:center; gap:8px; margin-top:10px"><input type="checkbox" id="b_list"/> <span>List my company for inbound opportunities</span></label>
          <div class="hr"></div>
          <div class="small">We only serve <strong>packaging</strong>.</div>
          <div class="err" id="b_err"></div><div class="ok" id="b_ok"></div>
          <div class="actions"><button class="btn" id="b_cancel">Cancel</button><button class="btn primary" id="b_continue">Continue</button></div>
        </div>
      </div>

      <div>
        <div class="card">
          <div class="label"><strong>Tips to get great signals</strong></div>
          <ul class="small" style="margin:0 0 8px 16px; padding:0">
            <li>Use your company domain to calibrate fit and block scrapers.</li>
            <li>Focus on physical packaging: corrugate, film, shrink, label, tray, case-of-N.</li>
            <li>Seed 3–6 buyers you admire to nudge platform rotation.</li>
          </ul>
          <div class="hr"></div>
          <div class="small">Privacy: Free hides raw sources on cards; Pro shows full checks. We log per-user proof confirmations only.</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Video modal -->
<div class="modal vmodal" id="vid">
  <div class="box">
    <div class="vhead"><div style="font:800 14px var(--mont)">90s demo</div><button class="btn" id="vclose">Close</button></div>
    <div class="vbody">
      <iframe id="vframe" src="https://www.youtube.com/embed/dQw4w9WgXcQ?rel=0&modestbranding=1" allow="autoplay; encrypted-media" allowfullscreen></iframe>
    </div>
  </div>
</div>

<script>
/* API base + sticky user */
(function(){
  if (window.API && window.API.base) return;
  const DEFAULT=(window.API_DEFAULT||'').replace(/\/$/,'') || location.origin;
  const qs=new URLSearchParams(location.search);
  function normalize(v){ if(!v) return DEFAULT; let s=String(v).trim().replace(/\/$/,''); if(!/^https?:\/\//i.test(s)) s='https://'+s; return s; }
  const saved=localStorage.getItem('apiBase'); const base=normalize(qs.get('api')||saved||DEFAULT);
  window.API_BASE=base;
  const _fetch=window.fetch.bind(window);
  const uidKey='galactly_uid'; let uid=localStorage.getItem(uidKey)||('u_'+Math.random().toString(36).slice(2)); localStorage.setItem(uidKey, uid);
  window.fetch=function(input,init){
    let url=(typeof input==='string')?input:input.url; const headers=new Headers((init&&init.headers)||(typeof input!=='string'&&input.headers)||undefined);
    try{ headers.set('x-galactly-user', uid);}catch{}
    if(url && (url.startsWith('/api/')||url.startsWith('api/'))){ url = base + (url.startsWith('/')? '': '/') + url; }
    return _fetch(typeof input==='string'?url:new Request(url,{...(init||{}),headers}));
  };
  window.API={ get base(){return base;}, uid, url:(p)=> (base + (p.startsWith('/')?p:'/'+p)) };
})();

/* Presence badge */
async function loadPresence(){ try{ const r=await fetch('/presence/online'); const j=await r.json(); document.getElementById('presenceTxt').textContent=(j.total||0)+' online'; }catch{} }
setInterval(loadPresence, 12000); loadPresence();

/* ===== RIGHT HERO CANVAS ===== */
(function(){
  const root = document.getElementById('hero-right');
  const canvas = document.getElementById('hero-right-canvas');
  if(!root || !canvas || !canvas.getContext) return;
  const ctx = canvas.getContext('2d', { alpha:true });

  const CONFIG = {
    centerBiasX: 0.70, centerBiasY: 0.56, coreRadiusPct: 0.095,
    inboundMax: 90, outboundMax: 70, spawnArcWidth: 0.85,
    speeds: { inboundAccel: 0.11, swirl: 0.035, friction: 0.986, outboundMin: 0.008, outboundJitter: 0.6 },
    endpoints: [
      { label:'Email',    angle:-0.22, tint:'rgba(180,220,255,0.9)' },
      { label:'SMS',      angle:-0.08, tint:'rgba(130,255,210,0.9)' },
      { label:'Call',     angle: 0.06, tint:'rgba(200,220,255,0.9)' },
      { label:'LinkedIn', angle: 0.18, tint:'rgba(160,210,255,0.9)' },
      { label:'Quote',    angle: 0.30, tint:'rgba(255,235,160,0.9)' },
      { label:'ERP',      angle: 0.42, tint:'rgba(210,190,255,0.9)' }
    ]
  };

  let w=0,h=0,dpr=1,cx=0,cy=0,R=0, grads=[];
  function resize(){
    dpr = Math.max(1, Math.min(2, window.devicePixelRatio||1));
    w = canvas.clientWidth; h = canvas.clientHeight;
    canvas.width = Math.floor(w*dpr); canvas.height = Math.floor(h*dpr);
    ctx.setTransform(dpr,0,0,dpr,0,0);
    cx = w*CONFIG.centerBiasX; cy = h*CONFIG.centerBiasY;
    R  = Math.min(w,h)*CONFIG.coreRadiusPct;

    CONFIG.endpoints.forEach((e,i)=>{
      const len = Math.min(240 + i*26, Math.min(w,h)*0.52);
      e.x = cx + Math.cos(e.angle)*len;
      e.y = cy + Math.sin(e.angle)*len;
      const g = ctx.createLinearGradient(cx,cy, e.x,e.y);
      g.addColorStop(0, 'rgba(255,255,255,0.9)');
      g.addColorStop(1, e.tint.replace(/0\.9\)/,'0.35)'));
      grads[i] = g;
    });
  }
  if (window.ResizeObserver) new ResizeObserver(resize).observe(root);
  window.addEventListener('resize', resize);
  resize();

  const inbound=[], outbound=[];
  function spawnInbound(){
    const ring = Math.max(w,h)*0.6;
    const arc  = CONFIG.spawnArcWidth * Math.PI;
    const a = Math.PI + (Math.random()*arc - arc/2);
    inbound.push({ x: cx + Math.cos(a)*ring, y: cy + Math.sin(a)*ring, vx:0, vy:0, life:360 + Math.random()*260, hue:190 + Math.random()*40 });
  }
  function spawnOutbound(){
    const e = CONFIG.endpoints[Math.floor(Math.random()*CONFIG.endpoints.length)];
    outbound.push({ e, t:0, spd: CONFIG.speeds.outboundMin + Math.random()*0.006, jx:(Math.random()-.5)*CONFIG.speeds.outboundJitter, jy:(Math.random()-.5)*CONFIG.speeds.outboundJitter });
  }

  function drawContinents(){
    ctx.save(); ctx.translate(w*0.38, h*0.46); ctx.rotate(-0.08);
    ctx.fillStyle='rgba(160,190,220,0.08)'; ctx.strokeStyle='rgba(160,190,220,0.12)'; ctx.lineWidth=1;

    ctx.beginPath();
    ctx.moveTo(-120,-40); ctx.lineTo(-90,-80); ctx.lineTo(-30,-90); ctx.lineTo(20,-70);
    ctx.lineTo(10,-30); ctx.lineTo(-40,-10); ctx.lineTo(-80,10); ctx.closePath(); ctx.fill(); ctx.stroke();

    ctx.beginPath();
    ctx.moveTo(10,0); ctx.lineTo(50,10); ctx.lineTo(80,40); ctx.lineTo(60,100); ctx.lineTo(20,130); ctx.lineTo(0,90); ctx.closePath();
    ctx.fill(); ctx.stroke();
    ctx.restore();

    ctx.strokeStyle='rgba(140,170,220,0.12)'; ctx.lineWidth=1;
    for(let i=1;i<=3;i++){ ctx.beginPath(); ctx.arc(cx,cy,R*(2+i*1.12),0,Math.PI*2); ctx.stroke(); }
  }

  let travelT=0;
  function drawTravelPath(){
    const sx=w*0.43, sy=h*0.42;
    const cp1x=w*0.56, cp1y=h*0.40, cp2x=w*0.62, cp2y=h*0.52, ex=cx, ey=cy;
    ctx.strokeStyle='rgba(170,200,255,0.18)'; ctx.lineWidth=1.2;
    ctx.beginPath(); ctx.moveTo(sx,sy); ctx.bezierCurveTo(cp1x,cp1y,cp2x,cp2y,ex,ey); ctx.stroke();

    travelT=(travelT+0.012)%1;
    const t=travelT, it=1-t;
    const x=it*it*it*sx + 3*it*it*t*cp1x + 3*it*t*t*cp2x + t*t*t*ex;
    const y=it*it*it*sy + 3*it*it*t*cp1y + 3*it*t*t*cp2y + t*t*t*ey;
    ctx.fillStyle='rgba(255,255,255,0.96)';
    ctx.beginPath(); ctx.arc(x,y,1.8,0,Math.PI*2); ctx.fill();
  }

  function drawCore(){
    const g=ctx.createRadialGradient(cx,cy,0,cx,cy,R*2.4);
    g.addColorStop(0,'rgba(255,255,255,0.9)');
    g.addColorStop(0.2,'rgba(200,230,255,0.55)');
    g.addColorStop(1,'rgba(120,160,255,0.02)');
    ctx.fillStyle=g; ctx.beginPath(); ctx.arc(cx,cy,R,0,Math.PI*2); ctx.fill();
    ctx.strokeStyle='rgba(210,235,255,0.45)'; ctx.lineWidth=1.5; ctx.beginPath(); ctx.arc(cx,cy,R*1.18,0,Math.PI*2); ctx.stroke();
  }
  function drawBeams(){
    CONFIG.endpoints.forEach((e,i)=>{
      ctx.strokeStyle = grads[i]; ctx.lineWidth=2;
      ctx.beginPath(); ctx.moveTo(cx,cy); ctx.lineTo(e.x,e.y); ctx.stroke();

      ctx.fillStyle='rgba(160,200,255,0.35)'; ctx.beginPath(); ctx.arc(e.x,e.y,12,0,Math.PI*2); ctx.fill();
      ctx.fillStyle='rgba(255,255,255,0.85)'; ctx.beginPath(); ctx.arc(e.x,e.y,3.2,0,Math.PI*2); ctx.fill();

      ctx.font='12px Inter,system-ui'; ctx.textBaseline='middle'; ctx.fillStyle='rgba(225,235,255,0.95)';
      ctx.fillText(e.label, e.x+16, e.y);
    });
  }

  function drawBg(){
    const g=ctx.createRadialGradient(cx-120, cy, R*0.6, cx, cy, Math.max(w,h)*0.9);
    g.addColorStop(0,'rgba(72,100,160,0.08)'); g.addColorStop(1,'rgba(0,0,0,0)');
    ctx.fillStyle=g; ctx.fillRect(0,0,w,h);
  }

  const inbound=[], outbound=[];
  function tickInbound(){
    while(inbound.length<CONFIG.inboundMax) spawnInbound();
    for(let i=inbound.length-1;i>=0;i--){
      const p=inbound[i], dx=cx-p.x, dy=cy-p.y, dist=Math.hypot(dx,dy)||1;
      const ax=(dx/dist)*CONFIG.speeds.inboundAccel, ay=(dy/dist)*CONFIG.speeds.inboundAccel;
      const swirl=CONFIG.speeds.swirl;
      p.vx=(p.vx+ax+(-dy/dist)*swirl)*CONFIG.speeds.friction;
      p.vy=(p.vy+ay+( dx/dist)*swirl)*CONFIG.speeds.friction;
      p.x+=p.vx; p.y+=p.vy; p.life--;

      ctx.strokeStyle=`hsla(${p.hue}, 80%, 75%, ${Math.max(.06, 0.18-0.0004*(360-p.life))})`;
      ctx.lineWidth=1; ctx.beginPath(); ctx.moveTo(p.x,p.y); ctx.lineTo(p.x-p.vx*3,p.y-p.vy*3); ctx.stroke();
      ctx.fillStyle='rgba(255,255,255,0.95)'; ctx.beginPath(); ctx.arc(p.x,p.y,1.15,0,Math.PI*2); ctx.fill();

      if(dist<R*0.95 || p.life<=0){ inbound.splice(i,1); spawnOutbound(); }
    }
  }
  function tickOutbound(){
    while(outbound.length<CONFIG.outboundMax) spawnOutbound();
    for(let i=outbound.length-1;i>=0;i--){
      const o=outbound[i]; o.t+=o.spd; if(o.t>=1){ outbound.splice(i,1); continue; }
      const bx=cx+(o.e.x-cx)*o.t + Math.sin(o.t*10)*o.jx*5;
      const by=cy+(o.e.y-cy)*o.t + Math.cos(o.t*10)*o.jy*5;
      const sz=1.1+Math.sin(o.t*Math.PI)*1.3;
      ctx.fillStyle='rgba(255,255,255,0.96)';
      ctx.beginPath(); ctx.arc(bx,by,sz,0,Math.PI*2); ctx.fill();
    }
  }

  function frame(){
    ctx.clearRect(0,0,w,h);
    drawBg();
    drawContinents();
    drawBeams();
    drawTravelPath();
    tickInbound();
    drawCore();
    tickOutbound();
    requestAnimationFrame(frame);
  }
  frame();

  // KPI motion
  const kEls={
    leads:document.getElementById('hr_k_leads'),
    ready:document.getElementById('hr_k_ready'),
    quoted:document.getElementById('hr_k_quoted'),
    rep:document.getElementById('hr_k_rep'),
    saved:document.getElementById('hr_k_saved')
  };
  const k={leads:0,t:0};
  setInterval(()=>{
    k.t++;
    if(k.leads<207) k.leads += 1 + (Math.random()<.35?1:0);
    if(kEls.leads)  kEls.leads.textContent = k.leads;
    if(kEls.ready)  kEls.ready.textContent = (54 + Math.round(Math.sin(k.t/7)*4)) + '%';
    if(kEls.quoted) kEls.quoted.textContent= (67 + Math.round(Math.cos(k.t/11)*3)) + '%';
    if(kEls.rep)    kEls.rep.textContent   = (21 + Math.round(Math.sin(k.t/5)*2)) + '%';
    if(kEls.saved){ const v=20678 + Math.round(Math.sin(k.t/3)*620); kEls.saved.textContent = '$'+v.toLocaleString(); }
  }, 900);
})();

/* CTA & modal behavior */
document.getElementById('watchDemo').onclick=()=> document.getElementById('vid').classList.add('in');
document.getElementById('vclose').onclick=()=>{ document.getElementById('vid').classList.remove('in'); document.getElementById('vframe').src=document.getElementById('vframe').src; };
document.addEventListener('keydown', e=>{ if(e.key==='Escape'){ document.getElementById('vid').classList.remove('in'); document.getElementById('onb').classList.remove('in'); } });

/* Gating helpers */
function bareHost(url){ let s=String(url||'').trim(); s=s.replace(/^https?:\/\//i,'').replace(/\/.*$/,'').replace(/^www\./i,''); return s.toLowerCase(); }
function emailDomain(email){ const m=String(email||'').trim().toLowerCase().match(/^[^@]+@([^@]+)$/); return m? m[1].replace(/^www\./,'') : ''; }
function domainsMatch(emailDom, siteDom){ if(!emailDom || !siteDom) return false; if(emailDom===siteDom) return true; return emailDom.endsWith('.'+siteDom); }
function isPackagingRole(role){ return role==='supplier' || role==='distributor' || role==='buyer'; }
async function post(path,body){ const r=await fetch((window.API_BASE||'')+path,{ method:'POST', headers:{'content-type':'application/json'}, body: JSON.stringify(body||{}) }); return r.json(); }

/* Path A */
document.getElementById('a_continue').onclick=async ()=>{
  const email=(document.getElementById('a_email').value||'').trim();
  const role =(document.getElementById('a_role').value||'supplier').trim();
  const site =(document.getElementById('a_site').value||'').trim();
  const region=(document.getElementById('a_region').value||'').trim();
  const list =!!document.getElementById('a_list').checked;
  const err=document.getElementById('a_err'); const ok=document.getElementById('a_ok'); err.style.display='none'; ok.style.display='none';
  const eDom=emailDomain(email), sDom=bareHost(site);
  if(!email||!sDom){ err.textContent='Please provide business email and company website.'; err.style.display='block'; return; }
  if(!domainsMatch(eDom,sDom)){ err.textContent=`Email domain (${eDom}) must match company site (${sDom}).`; err.style.display='block'; return; }
  if(!isPackagingRole(role)){ err.textContent='We only serve packaging suppliers, distributors, and buyers.'; err.style.display='block'; return; }
  localStorage.setItem('onb_vendor', sDom);
  localStorage.setItem('onb_role', role);
  localStorage.setItem('onb_regions', region);
  try{ await post('/api/v1/gate',{region,email,alerts:true}); }catch{}
  try{ await post('/api/v1/vault',{role,traits:{vendorDomain:sDom,industries:[],regions:region?region.split(',').map(s=>s.trim()):[],buyers:[]}}); ok.textContent='Validated. Opening feed…'; ok.style.display='block'; }catch{}
  location.href='./free-panel.html';
};
document.getElementById('a_cancel').onclick=()=> document.getElementById('onb').classList.remove('in');

/* Path B */
document.getElementById('b_continue').onclick=async ()=>{
  const email=(document.getElementById('b_email').value||'').trim();
  const role =(document.getElementById('b_role').value||'supplier').trim();
  const site =(document.getElementById('b_site').value||'').trim();
  const inds =(document.getElementById('b_industries').value||'').trim();
  const regs =(document.getElementById('b_regions').value||'').trim();
  const buyers=(document.getElementById('b_buyers').value||'').trim();
  const desc =(document.getElementById('b_desc').value||'').trim();
  const list =!!document.getElementById('b_list').checked;
  const err=document.getElementById('b_err'); const ok=document.getElementById('b_ok'); err.style.display='none'; ok.style.display='none';
  const eDom=emailDomain(email), sDom=bareHost(site);
  if(!email||!sDom){ err.textContent='Please provide business email and company website.'; err.style.display='block'; return; }
  if(!domainsMatch(eDom,sDom)){ err.textContent=`Email domain (${eDom}) must match company site (${sDom}).`; err.style.display='block'; return; }
  if(!isPackagingRole(role)){ err.textContent='We only serve packaging suppliers, distributors, and buyers.'; err.style.display='block'; return; }
  localStorage.setItem('onb_vendor', sDom);
  localStorage.setItem('onb_role', role);
  localStorage.setItem('onb_industries', inds);
  localStorage.setItem('onb_regions', regs);
  localStorage.setItem('onb_buyers', buyers);
  localStorage.setItem('onb_desc', desc);
  localStorage.setItem('onb_list', String(list));
  try{ await post('/api/v1/gate',{region:regs,email,alerts:true}); }catch{}
  try{ await post('/api/v1/vault',{role,traits:{vendorDomain:sDom,industries:inds?inds.split(',').map(s=>s.trim()):[],regions:regs?regs.split(',').map(s=>s.trim()):[],buyers:buyers?buyers.split(',').map(s=>s.trim()):[],notes:desc||null},listMe:list}); ok.textContent='Validated. Opening feed…'; ok.style.display='block'; }catch{}
  location.href='./free-panel.html';
};
document.getElementById('b_cancel').onclick=()=> document.getElementById('onb').classList.remove('in');
</script>
</body>
</html>
