<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Galactly — Find Packaging Buyers Now</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#0b0e13;--fg:#e8ecf1;--sub:#a6b3c4;--card:#111725;--stroke:#1f2a3b;--brand:#7dd3fc;--accent:#34d399;}
    *{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--fg);font-family:Inter,system-ui,Segoe UI,Roboto,Ubuntu,Helvetica,Arial,sans-serif}
    header{padding:20px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid var(--stroke)}
    header .logo{font-weight:800;letter-spacing:.5px}
    .wrap{max-width:1100px;margin:0 auto;padding:40px 20px}
    .hero{display:grid;grid-template-columns:1.1fr .9fr;gap:28px;align-items:center}
    .hero h1{font-size:40px;line-height:1.05;margin:0 0 12px}
    .hero p{color:var(--sub);margin:0 0 18px}
    .card{background:var(--card);border:1px solid var(--stroke);border-radius:16px;padding:18px}
    .cta{background:var(--brand);color:#082032;font-weight:700;border:none;border-radius:12px;padding:12px 16px;cursor:pointer}
    .muted{color:var(--sub)}

    /* Modal */
    .modal{position:fixed;inset:0;background:rgba(7,10,14,.6);display:none;align-items:center;justify-content:center;padding:20px}
    .modal.open{display:flex}
    .sheet{width:min(840px,100%);background:#0f1522;border:1px solid var(--stroke);border-radius:16px;overflow:hidden}
    .sheet header{display:flex;gap:10px;align-items:center;border:none;padding:16px 18px;background:#0e1520}
    .tabs{display:flex;gap:8px}
    .tab{background:#122034;border:1px solid var(--stroke);color:var(--fg);padding:8px 10px;border-radius:10px;cursor:pointer}
    .tab.active{outline:2px solid var(--brand)}
    .grid{display:grid;gap:16px;grid-template-columns:1fr 1fr;padding:18px}
    label{display:block;font-size:12px;color:var(--sub);margin-bottom:6px}
    input,textarea{width:100%;background:#0b1220;border:1px solid #263246;color:var(--fg);border-radius:10px;padding:10px}
    .row{display:flex;gap:10px}
    .btn{background:#1e2a3b;border:1px solid #2a3b55;color:var(--fg);padding:10px 14px;border-radius:10px;cursor:pointer}
    .btn.pri{background:var(--accent);border-color:#4ade80;color:#06210f;font-weight:700}
    .hint{font-size:12px;color:var(--sub)}
  </style>
  <script defer src="api-base.js"></script>
</head>
<body>
  <header>
    <div class="logo">Galactly</div>
    <div class="muted">API: <span id="apiTxt">loading…</span></div>
  </header>

  <div class="wrap">
    <div class="hero">
      <div>
        <h1>Instant packaging buyers, tailored to <em>your</em> shop</h1>
        <p>Two ways: paste your website and we infer your ICP, or hand‑pick industries & sample buyers. Then go to the free panel and claim leads.</p>
        <div class="row">
          <button id="openOnboard" class="cta">Start (free)</button>
          <button class="btn" onclick="location.href='free-panel.html'">Open free panel</button>
        </div>
        <p class="hint">No calls. No credit card. We’ll do 1–2 deep reveals/day on the free plan.</p>
      </div>
      <div class="card">
        <strong>How it works</strong>
        <ol>
          <li>Tell us your website <em>or</em> industries & example buyers.</li>
          <li>We fetch active demand signals (ads, procurement, PDP clues).</li>
          <li>In the free panel, <b>press & hold</b> to reveal one lead deeply/day.</li>
        </ol>
      </div>
    </div>
  </div>

  <!-- Onboarding Modal -->
  <div id="onboard" class="modal">
    <div class="sheet">
      <header>
        <div style="font-weight:700">Onboarding</div>
        <div class="tabs">
          <button class="tab active" data-tab="auto">Use my website</button>
          <button class="tab" data-tab="custom">Customize ICP</button>
        </div>
        <div style="margin-left:auto"><button class="btn" id="closeModal">Close</button></div>
      </header>
      <div class="grid">
        <!-- AUTO -->
        <div id="pane-auto">
          <label>Your website</label>
          <input id="vendorDomain" placeholder="acme‑packaging.com"/>
          <div class="row" style="margin-top:10px">
            <button class="btn pri" id="runAuto">Find buyers now</button>
            <span id="autoStatus" class="hint"></span>
          </div>
          <p class="hint">We’ll infer your ICP from your site and start collecting demand signals.</p>
        </div>
        <!-- CUSTOM -->
        <div id="pane-custom" style="display:none">
          <div class="row">
            <div style="flex:1">
              <label>Industries (comma‑sep)</label>
              <input id="industries" placeholder="beverage, confectionery, supplements"/>
            </div>
            <div style="flex:1">
              <label>Regions (comma‑sep, 2‑letter)</label>
              <input id="regions" placeholder="US, CA"/>
            </div>
          </div>
          <label style="margin-top:10px">Example buyers (one per line)</label>
          <textarea id="buyers" rows="6" placeholder="liquiddeath.com
soylent.com"></textarea>
          <div class="row" style="margin-top:10px">
            <button class="btn pri" id="runCustom">Find buyers now</button>
            <span id="customStatus" class="hint"></span>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
  // API display
  window.addEventListener('DOMContentLoaded',()=>{
    const t=document.getElementById('apiTxt'); t.textContent=(window.API_BASE||'').replace(/^https?:\/\//,'');
  });

  // Modal logic
  const modal = document.getElementById('onboard');
  document.getElementById('openOnboard').onclick=()=>modal.classList.add('open');
  document.getElementById('closeModal').onclick=()=>modal.classList.remove('open');
  const tabs=[...document.querySelectorAll('.tab')];
  const showTab = (k)=>{
    tabs.forEach(b=>b.classList.toggle('active', b.dataset.tab===k));
    document.getElementById('pane-auto').style.display = k==='auto'?'block':'none';
    document.getElementById('pane-custom').style.display = k==='custom'?'block':'none';
  };
  tabs.forEach(b=>b.onclick=()=>showTab(b.dataset.tab));

  // Simple user id
  const uidKey='galactly_uid'; let uid=localStorage.getItem(uidKey); if(!uid){ uid='u-'+Math.random().toString(36).slice(2); localStorage.setItem(uidKey,uid); }

  async function gate(){
    try{ await fetch('/api/v1/gate',{method:'POST',headers:{'content-type':'application/json','x-galactly-user':uid},body:JSON.stringify({alerts:true})}); }catch(e){}
  }

  async function findNow(payload){
    const r = await fetch('/api/v1/find-now',{method:'POST',headers:{'content-type':'application/json','x-galactly-user':uid},body:JSON.stringify(payload)});
    return r.json();
  }

  document.getElementById('runAuto').onclick = async ()=>{
    const vendorDomain = (document.getElementById('vendorDomain').value||'').trim();
    const s = document.getElementById('autoStatus'); s.textContent='Working…';
    await gate();
    try{
      const out = await findNow({ vendorDomain });
      s.textContent = `Created ${out.created||0} • Checked ${out.checked||0}`;
      setTimeout(()=>location.href='free-panel.html', 600);
    }catch(e){ s.textContent = 'Error. Check API base.'; }
  };

  document.getElementById('runCustom').onclick = async ()=>{
    const buyers = (document.getElementById('buyers').value||'').split(/\r?\n/).map(s=>s.trim()).filter(Boolean);
    const industries = (document.getElementById('industries').value||'').split(',').map(s=>s.trim()).filter(Boolean);
    const regions = (document.getElementById('regions').value||'').split(',').map(s=>s.trim()).filter(Boolean);
    const s = document.getElementById('customStatus'); s.textContent='Working…';
    await gate();
    try{
      const out = await findNow({ buyers, industries, regions });
      s.textContent = `Created ${out.created||0} • Checked ${out.checked||0}`;
      setTimeout(()=>location.href='free-panel.html', 600);
    }catch(e){ s.textContent = 'Error. Check API base.'; }
  };
</script>
</body>
</html>
