<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Galactly — Live packaging buyer signals</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Montserrat:wght@800&display=swap" rel="stylesheet">
<style>
:root{
  --ink:#eaf0ff; --mut:#a6b2c9; --line:#1e2737; --card:#0f1420; --panel:#0b101a; --pill:#10182a;
  --accent:#86f7d6; --accent2:#6fb3ff; --ok:#7fffd4; --bad:#ff8a8a;
  --mont:Montserrat,Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial,sans-serif;
  --inter:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial,sans-serif;
}
*{box-sizing:border-box} html,body{height:100%}
body{margin:0;color:var(--ink);background:linear-gradient(180deg,#0a0e16,#06080e 60%);font-family:var(--inter)}
header{height:60px;display:flex;align-items:center;justify-content:space-between;padding:0 18px;border-bottom:1px solid var(--line);background:linear-gradient(180deg,#0b111b,#0a0e15)}
.brand{display:flex;gap:10px;align-items:center;font:800 16px var(--mont)}
.brand svg{width:22px;height:22px}
.badge{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border:1px solid var(--line);border-radius:999px;background:#0c1322;color:#c9d6f0;font-size:12px}
.badge .dot{width:8px;height:8px;border-radius:50%;background:#43e5b7;box-shadow:0 0 10px rgba(67,229,183,.7);display:inline-block}

.wrap{max-width:1280px;margin:0 auto;padding:26px 18px}
.hero{display:grid;grid-template-columns:minmax(420px, 52%) 1fr;gap:26px;align-items:center}
@media (max-width:1080px){ .hero{grid-template-columns:1fr} }
.h1{font:800 clamp(34px,6vw,56px) var(--mont);letter-spacing:-.02em;line-height:1.06;margin:0 0 12px}
.h1 .hi{color:var(--accent)} .h1 .t{color:#9ec8ff}
.sub{color:#cfdbff;opacity:.9;font-size:15px;margin:0 0 12px}
.cta{margin-top:16px;display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.btn{border-radius:14px;padding:12px 16px;font:700 14px var(--inter);background:var(--pill);border:1px solid var(--line);color:var(--ink);cursor:pointer}
.btn.primary{background:linear-gradient(90deg,#fff,#e6efff);color:#0b111b;border-color:transparent}
.kv{margin-top:10px;font-size:12px;color:#c6d5f3;opacity:.95}

.hright{position:relative;height:520px;border:1px solid #1e2737;border-radius:18px;overflow:hidden;background:radial-gradient(600px 380px at 43% 55%, rgba(120,160,255,.14), rgba(10,14,22,1) 65%)}
#hero-right-canvas{width:100%;height:100%;display:block;pointer-events:none}
.hright-kpis{position:absolute;left:18px;right:18px;bottom:14px;display:flex;gap:10px;flex-wrap:wrap}
.hright-chip{display:inline-flex;align-items:center;gap:8px;padding:7px 10px;border:1px solid #26314a;border-radius:999px;background:rgba(10,16,28,.82);color:#cfe0ff;font-size:12px;backdrop-filter: blur(6px)}

/* Modal */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.55);display:none;align-items:center;justify-content:center;z-index:50}
.modal.in{display:flex}
.box{width:min(920px,95vw);background:#0b101a;border:1px solid var(--line);border-radius:16px;overflow:hidden}
.box .head{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;border-bottom:1px solid var(--line)}
.box h3{margin:0;font:800 16px var(--mont)}
.seg{display:flex;gap:6px}
.tab{padding:8px 10px;border:1px solid var(--line);border-radius:999px;font:700 12px var(--inter);cursor:pointer}
.tab.active{background:linear-gradient(90deg,#fff,#e6efff);color:#10131a;border-color:transparent}
.pane{display:grid;grid-template-columns:1.08fr 1fr;gap:16px;padding:14px}
@media (max-width: 900px){ .pane{grid-template-columns:1fr} }
.card{background:#0f1420;border:1px solid var(--line);border-radius:14px;padding:12px}
.label{font-size:12px;opacity:.9;margin-bottom:6px}
.input, select, textarea{width:100%;background:#0f1420;border:1px solid var(--line);color:#e9eef7;border-radius:10px;padding:10px 12px;font:500 13px var(--inter)}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.actions{display:flex;gap:10px;align-items:center;padding:12px 0 0}
.err{color:var(--bad);font-size:12px;margin-top:6px;display:none}
.ok{color:#a7ffde;font-size:12px;margin-top:6px;display:none}
.small{font-size:12px;opacity:.85}
.hr{height:1px;background:linear-gradient(90deg,transparent,#243048,transparent);margin:12px 0}
</style>
</head>
<body>
<header>
  <a class="brand" href="#">
    <svg viewBox="0 0 64 64" aria-hidden="true"><defs><linearGradient id="g" x1="0" y1="0" x2="1" y2="1"><stop offset="0" stop-color="#86f7d6"/><stop offset="1" stop-color="#57a4ff"/></linearGradient></defs><circle cx="32" cy="32" r="28" stroke="url(#g)" stroke-width="2" fill="none"/><circle cx="20" cy="20" r="6" fill="url(#g)"/></svg>
    <span>Galactly</span>
  </a>
  <span class="badge"><span class="dot"></span><span id="presenceTxt">0 online</span></span>
</header>

<div class="wrap">
  <section class="hero">
    <div>
      <h1 class="h1">Find US &amp; Canada <span class="hi">Packaging</span> Buyers in <span class="t">&lt;30s</span></h1>
      <p class="sub">Real posts &amp; tenders from public feeds. Free viewer; paid automations, priority, CRM &amp; reporting.</p>
      <p class="sub">Built for packaging owners &amp; sales teams. Outputs: Quote • Email • SMS • Call • LinkedIn DM • ERP updates. No coding. Just clicks.</p>
      <div class="cta">
        <button class="btn primary" id="startFree">Start free</button>
        <a class="btn" id="openFeed" href="./free-panel.html">Open the Live Feed</a>
        <span class="kv">AI closed <strong>16%</strong> • Rep closed <strong>21%</strong> • Saved / mo <strong>$20,678</strong></span>
      </div>
    </div>

    <div id="hero-right" class="hright">
      <canvas id="hero-right-canvas" aria-hidden="true"></canvas>
      <div class="hright-kpis">
        <div class="hright-chip">Leads / 30s <strong id="hr_k_leads">0</strong></div>
        <div class="hright-chip">First connection <strong>6 sec</strong></div>
        <div class="hright-chip">Ready now <strong id="hr_k_ready">54%</strong></div>
        <div class="hright-chip">Quoted <strong id="hr_k_quoted">67%</strong></div>
        <div class="hright-chip">Rep closed <strong id="hr_k_rep">21%</strong></div>
        <div class="hright-chip">Saved / mo <strong id="hr_k_saved">$20,678</strong></div>
      </div>
    </div>
  </section>
</div>

<!-- Onboarding modal -->
<div class="modal" id="onb">
  <div class="box">
    <div class="head">
      <h3>Onboarding</h3>
      <div class="seg">
        <button class="tab active" id="tabA">Path A — Enter your website</button>
        <button class="tab" id="tabB">Path B — Customize from scratch</button>
        localStorage.setItem('onb_email', email);
      </div>
    </div>
    <div class="pane">
      <div>
        <!-- PATH A -->
        <div class="card" id="paneA">
          <div class="label">Preferred — derive ICPs, buyers, and regions from your vendor site.</div>
          <div class="grid2">
            <div><div class="label">Business email *</div><input id="a_email" class="input" placeholder="you@yourcompany.com"/></div>
            <div><div class="label">Your role *</div>
              <select id="a_role" class="input">
                <option value="supplier">Supplier</option>
                <option value="distributor">Distributor/Wholesaler</option>
                <option value="buyer">Packaging Buyer</option>
              </select>
            </div>
          </div>
          <div class="label" style="margin-top:8px">Company website *</div>
          <input id="a_site" class="input" placeholder="yourcompany.com"/>
          <div class="grid2" style="margin-top:8px">
            <div><div class="label">Regions</div><input id="a_region" class="input" placeholder="US, CA"/></div>
            <div><label style="display:flex;align-items:center;gap:8px;margin-top:22px"><input type="checkbox" id="a_list"/> <span>List my company for inbound opportunities</span></label></div>
          </div>
          <div class="hr"></div>
          <div class="small">We only serve <strong>packaging</strong>. Business email domain must match your company site.</div>
          <div class="err" id="a_err"></div><div class="ok" id="a_ok"></div>
          <div class="actions"><button class="btn" id="a_cancel">Cancel</button><button class="btn primary" id="a_continue">Continue</button></div>
        </div>

        <!-- PATH B -->
        <div class="card" id="paneB" style="display:none">
          <div class="label">Manual — precise filters if you prefer to steer.</div>
          <div class="grid2">
            <div><div class="label">Business email *</div><input id="b_email" class="input" placeholder="you@yourcompany.com"/></div>
            <div><div class="label">Your role *</div>
              <select id="b_role" class="input">
                <option value="supplier">Supplier</option>
                <option value="distributor">Distributor/Wholesaler</option>
                <option value="buyer">Packaging Buyer</option>
              </select>
            </div>
          </div>
          <div class="label" style="margin-top:8px">Company website *</div>
          <input id="b_site" class="input" placeholder="yourcompany.com"/>
          <div class="grid2" style="margin-top:8px">
            <div><div class="label">Industries</div><input id="b_industries" class="input" placeholder="beverage, confectionery"/></div>
            <div><div class="label">Regions</div><input id="b_regions" class="input" placeholder="US, CA, EU"/></div>
          </div>
          <div class="label" style="margin-top:8px">Seed buyers (domains)</div>
          <input id="b_buyers" class="input" placeholder="brand1.com, brand2.com"/>
          <div class="label" style="margin-top:8px">Describe your ideal customers</div>
          <textarea id="b_desc" rows="4" class="input" placeholder="materials, order sizes, channels, exclusions"></textarea>
          <label style="display:flex;align-items:center;gap:8px;margin-top:10px"><input type="checkbox" id="b_list"/> <span>List my company for inbound opportunities</span></label>
          <div class="hr"></div>
          <div class="small">We only serve <strong>packaging</strong>.</div>
          <div class="err" id="b_err"></div><div class="ok" id="b_ok"></div>
          <div class="actions"><button class="btn" id="b_cancel">Cancel</button><button class="btn primary" id="b_continue">Continue</button></div>
        </div>
      </div>

      <div>
        <div class="card">
          <div class="label"><strong>Tips to get great signals</strong></div>
          <ul class="small" style="margin:0 0 8px 16px;padding:0">
            <li>Use your company domain to calibrate fit and block scrapers.</li>
            <li>Focus on physical packaging: corrugate, film, shrink, label, tray, case-of-N.</li>
            <li>Seed 3–6 buyers you admire to nudge platform rotation.</li>
          </ul>
          <div class="hr"></div>
          <div class="small">Privacy: Free hides raw sources on cards; Pro shows full checks. We log per-user proof confirmations only.</div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
/* --------------------- API base + sticky user --------------------- */
(function(){
  const qs=new URLSearchParams(location.search);
  const saved=localStorage.getItem('apiBase');
  const explicit=qs.get('api');
  const isFile = location.protocol==='file:';
  const fallback = 'http://localhost:8080';
  const base = (explicit||saved||(isFile?fallback:(location.origin||fallback))).replace(/\/$/,'');
  localStorage.setItem('apiBase', base);
  const _fetch=window.fetch.bind(window);
  const uidKey='galactly_uid'; const uid=localStorage.getItem(uidKey)||('u_'+Math.random().toString(36).slice(2)); localStorage.setItem(uidKey, uid);
  window.fetch=function(input,init){
    let url=(typeof input==='string')?input:input.url; const headers=new Headers((init&&init.headers)||(typeof input!=='string'&&input.headers)||undefined);
    headers.set('x-galactly-user', uid);
    if(url && (url.startsWith('/api/')||url.startsWith('api/')||url.startsWith('/presence/')||url.startsWith('presence/'))){
      url = base + (url.startsWith('/')? '': '/') + url;
    }
    return _fetch(typeof input==='string'?url:new Request(url,{...(init||{}),headers}));
  };
  window.API={ base, uid, url:(p)=> (base + (p.startsWith('/')?p:'/'+p)) };
})();

/* presence */
async function loadPresence(){ try{ const r=await fetch('/presence/online'); const j=await r.json(); document.getElementById('presenceTxt').textContent=(j.total||0)+' online'; }catch{} }
setInterval(loadPresence, 12000); loadPresence();

/* modal open/close + tabs */
const onb=document.getElementById('onb');
document.getElementById('startFree').onclick=()=> onb.classList.add('in');
document.getElementById('a_cancel').onclick=()=> onb.classList.remove('in');
document.getElementById('b_cancel').onclick=()=> onb.classList.remove('in');
const tabA=document.getElementById('tabA'), tabB=document.getElementById('tabB');
const paneA=document.getElementById('paneA'), paneB=document.getElementById('paneB');
tabA.onclick=()=>{ tabA.classList.add('active'); tabB.classList.remove('active'); paneA.style.display='block'; paneB.style.display='none'; };
tabB.onclick=()=>{ tabB.classList.add('active'); tabA.classList.remove('active'); paneB.style.display='block'; paneA.style.display='none'; };

/* helpers */
function bareHost(url){ let s=String(url||'').trim(); s=s.replace(/^https?:\/\//i,'').replace(/\/.*$/,'').replace(/^www\./i,''); return s.toLowerCase(); }
function emailDomain(email){ const m=String(email||'').trim().toLowerCase().match(/^[^@]+@([^@]+)$/); return m? m[1].replace(/^www\./,'') : ''; }
function domainsMatch(emailDom, siteDom){ if(!emailDom || !siteDom) return false; if(emailDom===siteDom) return true; return emailDom.endsWith('.'+siteDom); }
function isPackagingRole(role){ return role==='supplier' || role==='distributor' || role==='buyer'; }
async function post(path,body){ const r=await fetch((window.API.base||'')+path,{ method:'POST', headers:{'content-type':'application/json'}, body: JSON.stringify(body||{}) }); return r.json(); }

/* Path A → save + navigate */
document.getElementById('a_continue').onclick=async ()=>{
  const email=(document.getElementById('a_email').value||'').trim();
  const role =(document.getElementById('a_role').value||'supplier').trim();
  const site =(document.getElementById('a_site').value||'').trim();
  const regions=(document.getElementById('a_region').value||'').trim();
  const list =!!document.getElementById('a_list').checked;
  const err=document.getElementById('a_err'); const ok=document.getElementById('a_ok'); err.style.display='none'; ok.style.display='none';
  const eDom=emailDomain(email), sDom=bareHost(site);
  if(!email||!sDom){ err.textContent='Please provide business email and company website.'; err.style.display='block'; return; }
  if(!domainsMatch(eDom,sDom)){ err.textContent=`Email domain (${eDom}) must match company site (${sDom}).`; err.style.display='block'; return; }
  if(!isPackagingRole(role)){ err.textContent='We only serve packaging suppliers, distributors, and buyers.'; err.style.display='block'; return; }

  // persist onboarding to prefill free-panel
  localStorage.setItem('onb_role', role);
  localStorage.setItem('onb_site', sDom);
  localStorage.setItem('onb_regions', regions);

  try{
    await post('/api/v1/gate',{region:regions,email,alerts:true});
    await post('/api/v1/vault',{role,traits:{vendorDomain:sDom,industries:[],regions:regions?regions.split(',').map(s=>s.trim()):[],buyers:[]},listMe:list});
    ok.textContent='Validated. Opening feed…'; ok.style.display='block';
  }catch{}
  location.href='./free-panel.html';
};

/* Path B → save + navigate */
document.getElementById('b_continue').onclick=async ()=>{
  const email=(document.getElementById('b_email').value||'').trim();
  const role =(document.getElementById('b_role').value||'supplier').trim();
  const site =(document.getElementById('b_site').value||'').trim();
  const inds =(document.getElementById('b_industries').value||'').trim();
  const regs =(document.getElementById('b_regions').value||'').trim();
  const buyers=(document.getElementById('b_buyers').value||'').trim();
  const desc =(document.getElementById('b_desc').value||'').trim();
  const list =!!document.getElementById('b_list').checked;
  const err=document.getElementById('b_err'); const ok=document.getElementById('b_ok'); err.style.display='none'; ok.style.display='none';

  const eDom=emailDomain(email), sDom=bareHost(site);
  if(!email||!sDom){ err.textContent='Please provide business email and company website.'; err.style.display='block'; return; }
  if(!domainsMatch(eDom,sDom)){ err.textContent=`Email domain (${eDom}) must match company site (${sDom}).`; err.style.display='block'; return; }
  if(!isPackagingRole(role)){ err.textContent='We only serve packaging suppliers, distributors, and buyers.'; err.style.display='block'; return; }

  localStorage.setItem('onb_role', role);
  localStorage.setItem('onb_site', sDom);
  localStorage.setItem('onb_industries', inds);
  localStorage.setItem('onb_regions', regs);
  localStorage.setItem('onb_buyers', buyers);
  localStorage.setItem('onb_desc', desc);

  try{
    await post('/api/v1/gate',{region:regs,email,alerts:true});
    await post('/api/v1/vault',{role,traits:{vendorDomain:sDom,industries:inds?inds.split(',').map(s=>s.trim()):[],regions:regs?regs.split(',').map(s=>s.trim()):[],buyers:buyers?buyers.split(',').map(s=>s.trim()):[],notes:desc||null},listMe:list});
    ok.textContent='Validated. Opening feed…'; ok.style.display='block';
  }catch{}
  location.href='./free-panel.html';
};
</script>
</body>
</html>
